# mcp_tools/exploit_framework/searchsploit.py
# aka. exploit-db

from typing import Dict, Any

def register_searchsploit_tool(mcp, hexstrike_client, logger):
    @mcp.tool()
    def exploit_db(query: str, additional_args: str = "") -> Dict[str, Any]:
        """
        Execute SearchSploit for local exploit database searching with enhanced logging.

        Args:
            query: The search query (e.g., "apache 2.4.49")
            additional_args: Additional SearchSploit arguments

        Returns:
            Search results from the local exploit database
        """
        data = {
            "query": query,
            "additional_args": additional_args
        }
        logger.info(f"üîç Starting SearchSploit: {query}")
        result = hexstrike_client.safe_post("api/tools/exploit_framework/searchsploit", data)
        if result.get("success"):
            logger.info(f"‚úÖ SearchSploit completed for {query}")
        else:
            logger.error(f"‚ùå SearchSploit failed for {query}")
        return result