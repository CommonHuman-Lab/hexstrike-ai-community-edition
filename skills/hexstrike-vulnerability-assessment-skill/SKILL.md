---
name: hexstrike-vulnerability-assessment-skill
description: Perform automated vulnerability assessment and CVSS scoring using HexStrike AI tools. Use when user asks to "scan vulnerabilities", "assess security", "find CVEs", "check for exploits", or "run vulnerability scan".
metadata:
  author: HexStrike AI
  version: "1.0.0"
  mcp-server: hexstrike-ai-mcp
  category: vulnerability-assessment
---

# HexStrike AI Vulnerability Assessment Skill

## Purpose

Execute comprehensive vulnerability assessment with automated CVSS scoring, exploitability analysis, and remediation recommendations. Integrates multiple vulnerability scanners and correlates findings for accurate risk assessment.

## Prerequisites

- Target system identified from reconnaissance
- HexStrike AI MCP server connection
- Network access to target services
- Proper authorization for vulnerability scanning

## Core Workflow

### Phase 1: Automated Vulnerability Scanning

**Network Vulnerability Assessment**
```bash
# Comprehensive vulnerability scan
nuclei_scan(target="target.com", severity="info,low,medium,high,critical", output_format="json")

# Fast vulnerability detection
nuclei_scan(target="192.168.1.100", templates="cves,misconfiguration", concurrency=50)

# Targeted CVE scanning
nuclei_scan(target="target.com", templates="cves", severity="high,critical")
```

**Web Application Vulnerability Scanning**
```bash
# OWASP Top 10 vulnerability assessment
nikto_scan(target="http://target.com", output_file="/tmp/nikto-results.txt")

# Advanced web vulnerability scanning
nuclei_scan(target="http://target.com", templates="vulnerabilities,exposures", rate_limit=100)

# API security assessment
nuclei_scan(target="https://api.target.com", templates="misconfiguration,exposures")
```

**Database Vulnerability Assessment**
```bash
# SQL injection testing
sqlmap_scan(url="http://target.com/page.php?id=1", level=5, risk=3)

# Database enumeration
sqlmap_scan(url="http://target.com/search?q=test", dbs=true, batch=true)
```

### Phase 2: Specialized Vulnerability Scanning

**Content Management System Assessment**
```bash
# WordPress vulnerability scan
wpscan_analyze(url="http://target.com", enumerate="vp,vt,cb", output_format="json")

# WordPress plugin enumeration
wpscan_analyze(url="http://target.com", plugins_detection="aggressive")
```

**Container and Cloud Vulnerability Assessment**
```bash
# Docker image vulnerability scan
trivy_scan(scan_type="image", target="nginx:latest", severity="HIGH,CRITICAL", output_format="json")

# Container runtime security
docker_bench_security_scan(output_file="/tmp/docker-bench.json")

# Kubernetes security assessment
kube_bench_cis(targets="master,node", output_format="json")

# Cloud security assessment
prowler_scan(provider="aws", check_level="medium,high,critical", output_format="json")
```

**SSL/TLS Security Assessment**
```bash
# SSL configuration analysis
nmap_scan(target="target.com", scan_type="-sV --script ssl-enum-ciphers")

# SSL vulnerability detection
nmap_scan(target="target.com", scan_type="--script ssl-heartbleed,ssl-poodle,ssl-dh-params")
```

### Phase 3: Vulnerability Correlation and Analysis

**Cross-Tool Validation**
```bash
# Run multiple scanners for validation
nuclei_scan(target="target.com", templates="cves")
nikto_scan(target="http://target.com")
nmap_scan(target="target.com", scan_type="-sV --script vulners")
```

**Exploitability Analysis**
```bash
# Check for public exploits
searchsploit_query(query="apache 2.4", json_output=true)

# Metasploit module search
msf_search_module(keyword="apache", type="exploit")
```

**CVSS Scoring and Prioritization**
```python
# Automatic CVSS calculation based on findings
# Critical (9.0-10.0): Immediate action required
# High (7.0-8.9): Address within 24-48 hours
# Medium (4.0-6.9): Address within 1-2 weeks
# Low (0.1-3.9): Address in next maintenance cycle
```

### Phase 4: Remediation and Reporting

**Remediation Recommendations**
```bash
# Generate remediation report
# Priority 1: Patch critical vulnerabilities
# Priority 2: Update configurations
# Priority 3: Implement compensating controls
```

## Tool Integration Matrix

| Vulnerability Type | Primary Tool | Secondary Tool | Validation Tool |
|-------------------|--------------|----------------|-----------------|
| CVEs | nuclei | nmap (vulners) | searchsploit |
| Web Vulns | nuclei | nikto | sqlmap |
| Misconfig | nuclei | nmap | manual review |
| SSL/TLS | nmap | testssl.sh | openssl |
| Containers | trivy | docker-bench | kube-bench |
| Cloud | prowler | scout-suite | custom scripts |
| Databases | sqlmap | nmap | nuclei |

## Output Format

### Vulnerability Assessment Report

```json
{
  "scan_metadata": {
    "target": "target.com",
    "scan_date": "2024-01-15T10:30:00Z",
    "duration": "45 minutes",
    "tools_used": ["nuclei", "nikto", "nmap"]
  },
  "executive_summary": {
    "total_vulnerabilities": 15,
    "critical": 2,
    "high": 5,
    "medium": 6,
    "low": 2,
    "risk_score": 8.2
  },
  "vulnerabilities": [
    {
      "id": "CVE-2023-1234",
      "name": "Apache HTTP Server Buffer Overflow",
      "severity": "CRITICAL",
      "cvss_score": 9.8,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "affected_service": "Apache HTTP Server 2.4.54",
      "port": 80,
      "exploit_available": true,
      "exploit_complexity": "LOW",
      "remediation": "Update to Apache HTTP Server 2.4.57 or later",
      "references": [
        "https://nvd.nist.gov/vuln/detail/CVE-2023-1234",
        "https://httpd.apache.org/security/vulnerabilities_24.html"
      ]
    }
  ],
  "recommendations": [
    {
      "priority": "CRITICAL",
      "action": "Patch Apache HTTP Server immediately",
      "timeline": "24 hours",
      "effort": "Low"
    }
  ]
}
```

## Severity Classification

### Critical (CVSS 9.0-10.0)
- Remote code execution without authentication
- SQL injection with data exfiltration
- Default credentials on admin interfaces
- Known exploits in the wild

### High (CVSS 7.0-8.9)
- Privilege escalation vulnerabilities
- Authentication bypass
- Sensitive data exposure
- Remote code execution with authentication

### Medium (CVSS 4.0-6.9)
- Information disclosure
- Cross-site scripting (XSS)
- Insecure configurations
- Missing security headers

### Low (CVSS 0.1-3.9)
- Informational findings
- Best practice violations
- Minor configuration issues

## Constraints and Limitations

### Scanning Limitations
- **False Positives**: Automated scanners may produce false positives
- **Coverage**: Not all vulnerabilities can be detected automatically
- **Authentication**: Limited testing without credentials
- **Business Logic**: Cannot detect business logic vulnerabilities

### Ethical Constraints
- **Authorization**: Only scan systems you own or have written permission to test
- **Scope**: Stay within defined testing boundaries
- **Data Handling**: Protect any sensitive data discovered
- **Notification**: Follow responsible disclosure practices

### Technical Constraints
- **Network Impact**: Scanning may affect target performance
- **IDS/IPS Evasion**: Aggressive scanning may trigger security controls
- **Rate Limiting**: Some targets require throttled scanning
- **Tool Dependencies**: Results depend on tool coverage and updates

## Best Practices

### Before Scanning
1. Verify target scope and authorization
2. Check for rate limiting requirements
3. Schedule scans during maintenance windows if needed
4. Set up proper output logging

### During Scanning
1. Monitor target responsiveness
2. Adjust scan intensity based on target behavior
3. Document any scan interruptions
4. Validate critical findings manually

### After Scanning
1. Review and validate findings
2. Remove false positives
3. Prioritize based on CVSS and business impact
4. Generate actionable remediation steps

## Integration with Other Skills

### With reconnaissance-skill
- Use reconnaissance findings to target vulnerability scans
- Focus on discovered services and technologies
- Validate reconnaissance data with vulnerability data

### With exploitation-skill
- Provide vulnerability data for exploit selection
- Confirm exploitability of findings
- Validate security control effectiveness

### With reporting-skill
- Feed vulnerability data for report generation
- Provide risk metrics and trends
- Support compliance reporting requirements

## Troubleshooting

### Common Issues

**False Positives**
- Validate findings with multiple tools
- Perform manual verification
- Check for outdated vulnerability databases

**Scan Failures**
- Verify network connectivity
- Check for WAF/IPS blocking
- Adjust scan timing and intensity
- Review tool error messages

**Incomplete Coverage**
- Run multiple specialized scanners
- Combine authenticated and unauthenticated scans
- Use both active and passive scanning techniques

### Performance Optimization

**Speed Improvements**
- Use parallel scanning where appropriate
- Implement intelligent target selection
- Cache vulnerability database lookups
- Optimize scan parameters for target type

**Accuracy Improvements**
- Cross-reference findings across multiple tools
- Use authenticated scanning when possible
- Keep vulnerability databases updated
- Apply context-aware filtering

## Version History

- **1.0.0**: Initial release with comprehensive vulnerability assessment
- **1.1.0**: Added CVSS 3.1 scoring and risk prioritization
- **1.2.0**: Enhanced correlation engine and false positive reduction
- **2.0.0**: Full HexStrike AI MCP integration with 150+ tool support